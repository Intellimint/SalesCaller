Below is a single, self-contained prompt you can paste straight into **Replit Agent** so it will:

* retire the old Node/Express server
* make the FastAPI service the one and only backend + static host
* clean up ports, run-command, secrets, and tests
* leave you with one click-to-run Repl thatâ€™s production-ready for your pilot.

---

### ğŸ“œ REPLIT AGENT TASK â€“ â€œPROMOTE FASTAPI TO PRIMARYâ€

Youâ€™ve completed the FastAPI rewrite. Now finalize the migration and decommission the Node server.

---

#### 1 Â· Remove Node layer

* Delete `package.json`, `server.js`, `app.js`, any `/node_modules` folder, and the Heroku-style Procfile if present.
* Delete references to port 5000 in HTML or JS.

#### 2 Â· Serve frontend from FastAPI

* In `backend/main.py` (or `main.py`), keep:

```python
app.mount("/", StaticFiles(directory="static", html=True), name="static")
```

* Update every AJAX call in `/static/*.html` or `/static/app.js` to **relative paths** (`/api/upload-leads`, `/api/start`, `/api/calls`).  No hard-coded port numbers.

#### 3 Â· Consolidate run command

* **`.replit`**

```
run = "uvicorn backend.main:app --host 0.0.0.0 --port 3000 --reload"
```

* **`replit.nix`** â€“ drop Node packages; keep only:

```
python311
python311Packages.fastapi
python311Packages.uvicorn
python311Packages.httpx
python311Packages.aiosqlite
python311Packages.python-dotenv
sqlite
```

#### 4 Â· Environment & health

* Ensure the Replit Secret **`CALLBACK_URL`** is exactly:

```
https://callninja.replit.app/webhook
```

* Add a simple `/healthz` route that returns `{"status":"ok","queue": <queue length>}` so future uptime checks hit one endpoint.

#### 5 Â· Default prompt + sample CSV

* Place `prompts/default.txt`:

```
Hi, this is ${rep_name} from Luma. Quick questionâ€”are you happy with how many qualified leads you're getting each month?
```

* Put `data/sample.csv` with one row (your cell) so newcomers can test immediately.

#### 6 Â· Docs & README

* Overwrite `README.md`:

  1. **Setup** â€“ add secrets, click *Run*
  2. **Start a campaign** â€“ upload CSV â†’ click *Start* â†’ watch dashboard
  3. **DB files** live in `data.db` (persist across restarts)

#### 7 Â· Smoke test before commit

1. `poetry install` or `pip install -r requirements.txt` is run by nix.
2. Run Repl â†’ open `/` â€“ index page should load.
3. Upload `sample.csv`, click **Start** â†’ see row in dashboard with status `dialing`.
4. Receive call, hang up â†’ webhook marks status `done`; outcome appears.
5. `/healthz` returns 200 JSON.

If all five steps pass, commit the checkpoint and delete the obsolete Node code in the same commit.

---

**End of instructions â€“ after this, the Repl should run solely on FastAPI with the new queue, DB, webhook, and UI.**
